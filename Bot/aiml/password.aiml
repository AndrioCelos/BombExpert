<?xml version="1.0" encoding="UTF-8"?>
<aiml>
	<category>
		<pattern>resume password</pattern>
		<template>
			<srai>DeselectModule</srai>
			<think><set name='topic'>Bomb Password</set></think>
			<srai>SelectModule</srai>
			<srai>PasswordPrompt</srai>
		</template>
	</category>

	<topic name='Bomb Password'>
		<category>
			<pattern>InitModule</pattern>
			<template>
				<think>
					<set name='BombPasswordPosition'>1</set>
					<set name='BombPasswordPossible'><srai>Solver Password GetPasswords</srai></set>
				</think>
				<srai>PasswordPrompt</srai>
			</template>
		</category>

		<category>
			<pattern>PasswordPrompt</pattern>
			<template>
				<condition name='Fast'>
					<li value='true'><sentence><map name='Ordinal'><get name='BombPasswordPosition'/></map></sentence> position?</li>
					<li>Tell me the six possible letters for the <map name='Ordinal'><get name='BombPasswordPosition'/></map> position.</li>
				</condition>
			</template>
		</category>

		<category>
			<pattern>next instance</pattern>
			<template><srai>reset password</srai></template>
		</category>

		<category>
			<pattern><set>NATO</set> *</pattern>
			<template>
				<think>
					<set var='letters'><explode><srai>DecodeNato <star/> <star index='2'/></srai></explode></set>
					<set var='toCheck'><get name='BombPasswordPossible'/></set>
					<set var='possible'>nil</set>
					<set var='numberPossible'>0</set>
					<condition var='toCheck'>
						<li value='nil'></li>
						<li>
							<set var='word'><srai>XFirst <get var='toCheck'/></srai></set>
							<set var='toCheck'><srai>XRest <get var='toCheck'/></srai></set>

							<!-- Is the nth letter in this word one of the letters specified? -->
							<set var='match'>
								<srai>
									XContains
									<srai>XItem <get name='BombPasswordPosition'/> XS <explode><get var='word'/></explode></srai> XS
									<get var='letters'/>
								</srai>
							</set>

							<condition var='match' value='true'>
								<set var='possible'><srai>XAppend <get var='word'/> <get var='possible'/></srai></set>
								<set var='numberPossible'><map name='successor'><get var='numberPossible'/></map></set>
							</condition>
							<loop/>
						</li>
					</condition>
					<set name='BombPasswordPosition'><map name='successor'><get name='BombPasswordPosition'/></map></set>
					<set name='BombPasswordPossible'><get var='possible'/></set>
				</think>
				<delay>4</delay>
				<condition var='numberPossible'>
					<li value='0'>
						<think><srai>reset password</srai></think>
						No passwords match. Please start over.
					</li>
					<li value='1'><srai>PasswordTell <get var='possible'/></srai></li>
					<li value='2'><srai>PasswordTell <get var='possible'/></srai></li>
					<li value='3'><srai>PasswordTell <get var='possible'/></srai></li>
					<li><srai>PasswordPrompt</srai></li>
				</condition>
			</template>
		</category>

		<category>
			<pattern>PasswordTell *</pattern>
			<template>The password is '<star/>': <explode><star/></explode>.</template>
		</category>
		<category>
			<pattern>PasswordTell * *</pattern>
			<template>The password is '<star/>' or '<star index='2'/>'.</template>
		</category>
		<category>
			<pattern>PasswordTell * * *</pattern>
			<template>The password is '<star/>', '<star index='2'/>' or '<star index='3'/>'.</template>
		</category>

		<!-- Usage: Solver Password GetPasswords -->
		<!-- Returns the list of possible passwords. -->
		<category>
			<pattern>SolverFallback Password 1 GetPasswords</pattern>
			<template>about after again below could every first found great house large learn never other place plant point right small sound spell still study their there these thing think three water where which world would write</template>
		</category>
	</topic>
</aiml>
